####################################################################################################
##### NSPanel ESPHome Add-on for Climate control - Cool                                        #####
##### Add-on for https://github.com/Blackymas/NSPanel_HA_Blueprint                             #####
####################################################################################################

substitutions:
  ### Local thermostat defaults ###
  # https://esphome.io/components/climate/thermostat.html
  cooler_relay: "0" # Select 1 for "Relay 1", 2 for "Relay 2" or "0" to a dummy switch/disabled
  # https://esphome.io/components/climate/index.html#base-climate-configuration
  temp_min: "15"
  temp_max: "45"

  ##### DO NOT CHANGE THIS #####
  addon_climate_cool: "true"
  addon_climate_heat: "false"
  ##############################

climate:
  - platform: thermostat
    name: ${device_name} Thermostat
    id: thermostat_embedded
    sensor: temp_nspanel
    min_cooling_off_time: ${min_off_time}s
    min_cooling_run_time: ${min_run_time}s
    min_idle_time: ${min_idle_time}s
    visual:
      min_temperature: ${temp_min} ${temp_units}
      max_temperature: ${temp_max} ${temp_units}
      temperature_step: ${temp_step} ${temp_units}
    cool_action:
      - switch.turn_on: relay_${cooler_relay}
    idle_action:
      - switch.turn_off: relay_${cooler_relay}
    default_preset: "Off"
    on_boot_restore_from: memory
    preset:
      - name: "Off"
        default_target_temperature_high: ${temp_min} ${temp_units}
        mode: "off"
      - name: Home
        default_target_temperature_high: 21 ${temp_units}
    internal: false
    on_state:
      - logger.log: Climate state changed - Start
      - script.execute: addon_climate_update_page_climate
      - script.execute: addon_climate_update_page_home
      - logger.log: Climate state changed - End

packages:
  core_package: !include nspanel_esphome_addon_climate_base.yaml
